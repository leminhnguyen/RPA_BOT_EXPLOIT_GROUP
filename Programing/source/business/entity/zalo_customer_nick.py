from business.service.utils import as_text

class ZaloNick:
    def __init__(self, phone: str, nickname: str, *args):
        self._phone = phone
        self._nickname = nickname
        self.contact_found: bool = True
        self.status = {'Ngày giờ gửi tin': '', 'Trạng thái gửi tin': '', 'Ngày giờ trạng thái (nếu có)': '', 'Ghi chú': ''}
        self.record_status(*args)

    @property
    def nickname(self):
        return self._nickname

    @property
    def phone(self):
        return self._phone

    def show_infor(self):
        print(f"phone: {self._phone}")
        print(f"nickname: {self._nickname}")

    def get_infor(self):
        infor = {'SDT': self._phone, 'Tên nhóm': self._nickname}
        infor.update(self.status)
        return infor

    def record_status(self, chat_date: str = "", sending_status: str = "", extra_time: str = "", note: str = ""):
        self.status['Ngày giờ gửi tin'] = as_text(chat_date)
        self.status['Trạng thái gửi tin'] = as_text(sending_status)
        self.status['Ngày giờ trạng thái (nếu có)'] = as_text(extra_time)
        self.status['Ghi chú'] = as_text(note)

    def check_valid(self) -> bool:
        if not self.status['Ghi chú'] and self.contact_found:
            return True
        return False

    def __str__(self):
        return f"Nick({self._phone} - {self.contact_found} - {self.status})"
